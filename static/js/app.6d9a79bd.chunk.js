(this.webpackJsonp=this.webpackJsonp||[]).push([[0],{245:function(e,t,n){"use strict";n.d(t,"a",(function(){return ue}));var r=n(9),o=n.n(r),a=n(10),s=n.n(a),c=n(11),i=n.n(c),u=n(12),l=n.n(u),h=n(4),f=n.n(h),p=n(0),d=n.n(p),g=n(8),b=n(5),m=n(23),x=n(138),y=n(39),v=n(34),j=n(173),A=n(6);function w(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var o=f()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return l()(this,n)}}var C=n(361),I=n(362),O="#090C08",k="#474056",S="#8A95A5",R="#B9C6AE",B=function(e){i()(n,e);var t=w(n);function n(e){var r;return o()(this,n),(r=t.call(this,e)).changeBgColor=function(e){r.setState({bgColor:e})},r.colors={color1:"#090C08",color2:"#474056",color3:"#8A95A5",color4:"#B9C6AE"},r.state={name:"",bgColor:""},r}return s()(n,[{key:"render",value:function(){var e=this;return Object(A.jsx)(x.a,{source:C,resizeMode:"cover",style:N.image,children:Object(A.jsxs)(b.a,{style:N.container,children:[Object(A.jsx)(m.a,{style:N.title,children:"ChatApp"}),Object(A.jsxs)(b.a,{style:N.box1,children:[Object(A.jsxs)(b.a,{style:N.input,children:[Object(A.jsx)(y.a,{source:I,style:N.usernameIcon}),Object(A.jsx)(j.a,{style:N.inputText,onChangeText:function(t){return e.setState({name:t})},value:this.state.name,placeholder:"Your Username"})]}),Object(A.jsxs)(b.a,{style:N.colorBox,children:[Object(A.jsxs)(b.a,{style:N.colorTextBox,children:[Object(A.jsx)(m.a,{style:N.colorText,children:"Choose Background Color:"}),Object(A.jsxs)(b.a,{style:N.color,children:[Object(A.jsx)(v.a,{title:"",color:O,style:N.color1,onPress:function(){return e.changeBgColor(O)}}),Object(A.jsx)(v.a,{style:N.color2,onPress:function(){return e.changeBgColor(k)}}),Object(A.jsx)(v.a,{TouchableOpacity:!0,style:N.color3,onPress:function(){return e.changeBgColor(S)}}),Object(A.jsx)(v.a,{style:N.color4,onPress:function(){return e.changeBgColor(R)}})]})]}),Object(A.jsx)(b.a,{style:N.button,children:Object(A.jsx)(v.a,{style:N.buttonHeight,onPress:function(){return e.props.navigation.navigate("Chat",{name:e.state.name,bgColor:e.state.bgColor})},children:Object(A.jsx)(m.a,{style:N.buttonText,children:"Start Chatting"})})})]})]})]})})}}]),n}(d.a.Component),N=g.a.create({container:{flex:1,justifyContent:"center",alignItems:"center"},box1:{marginBottom:30,backgroundColor:"white",flexGrow:1,flexShrink:0,flexDirection:"column",justifyContent:"space-evenly",alignItems:"center",paddingTop:15,paddingBottom:15,borderRadius:10,height:260,minHeight:260,maxHeight:300,height:"44%",width:"88%"},title:{fontSize:45,fontWeight:"700",color:"#fff",justifyContent:"center",alignItems:"center",marginBottom:50},image:{justifyContent:"center",width:"100%",height:"100%"},button:{height:70,width:"88%",marginBottom:-15,marginLeft:15},buttonHeight:{backgroundColor:"#757083",height:50,width:"100%",flexDirection:"row",justifyContent:"space-evenly"},buttonText:{color:"#FFF",fontSize:16,fontWeight:"700"},input:{alignItems:"flex-start",flexDirection:"row",height:60,width:"88%",borderColor:"#757083",borderWidth:1,position:"relative"},usernameIcon:{padding:10,margin:20,height:20,width:20,resizeMode:"stretch",alignItems:"center",opacity:.5},inputText:{marginTop:15,marginLeft:3,opacity:.5,fontSize:16,fontWeight:"300",color:"#757083"},colorText:{color:"#757083",fontWeight:"300",fontSize:16,opacity:1,padding:5},colorTextBox:{alignItems:"stretch",width:"88%",justifyContent:"space-between",padding:10},color:{width:50,height:50,borderRadius:25,marginRight:10,marginLeft:0,width:250,flexDirection:"row",justifyContent:"space-between",flexShrink:0,alignItems:"flex-start",flexShrink:0},color1:{backgroundColor:"#090C08",width:50,height:50,borderRadius:25,borderColor:"#090C08"},color2:{backgroundColor:"#474056",width:50,height:50,borderRadius:25},color3:{backgroundColor:"#8A95A5",width:50,height:50,borderRadius:25},color4:{backgroundColor:"#B9C6AE",width:50,height:50,borderRadius:25},colorBox:{width:"88%",height:100,justifyContent:"center",alignItems:"center",position:"relative",marginRight:40}}),P=n(7),T=n.n(P),M=n(15),D=n.n(M),E=n(99),Y=n(16),J=n(144),U=n(125),L=n(27),z=n(244),F=n(1),Q=n.n(F),W=n(126),H=n(68),G=n(161),V=n(174),Z=n(175);n(204);function _(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var o=f()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return l()(this,n)}}var K=function(e){i()(n,e);var t=_(n);function n(){var e;o()(this,n);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).pickImage=function(){var t,n,r,o;return D.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,D.a.awrap(W.d());case 2:if(t=a.sent,n=t.status,a.prev=4,"granted"!==n){a.next=14;break}return a.next=8,D.a.awrap(W.b({mediaTypes:H.a.Images}).catch((function(e){console.error(e)})));case 8:if((r=a.sent).cancelled){a.next=14;break}return a.next=12,D.a.awrap(e.uploadImage(r.uri));case 12:o=a.sent,e.props.onSend({image:o});case 14:a.next=19;break;case 16:a.prev=16,a.t0=a.catch(4),console.error(a.t0);case 19:case"end":return a.stop()}}),null,null,[[4,16]],Promise)},e.takePhoto=function(){var t,n,r,o;return D.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,D.a.awrap(W.c());case 2:if(t=a.sent,n=t.status,a.prev=4,"granted"!==n){a.next=14;break}return a.next=8,D.a.awrap(W.a({mediaTypes:H.a.All}).catch((function(e){console.error(e)})));case 8:if((r=a.sent).cancelled){a.next=14;break}return a.next=12,D.a.awrap(e.uploadImage(r.uri));case 12:o=a.sent,e.props.onSend({image:o});case 14:a.next=19;break;case 16:a.prev=16,a.t0=a.catch(4),console.error(a.t0);case 19:case"end":return a.stop()}}),null,null,[[4,16]],Promise)},e.uploadImage=function(e){var t,n,r,o,a;return D.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,D.a.awrap(new Promise((function(t,n){var r=new XMLHttpRequest;r.onload=function(){t(r.response)},r.onerror=function(e){console.log(e),n(new TypeError("Network request failed"))},r.responseType="blob",r.open("GET",e,!0),r.send(null)})));case 2:return t=s.sent,n=e.split("/"),r=n[n.length-1],o=Z.default.storage().ref().child("images/"+r),s.next=8,D.a.awrap(o.put(t));case 8:return a=s.sent,t.close(),s.next=12,D.a.awrap(a.ref.getDownloadURL());case 12:return s.abrupt("return",s.sent);case 13:case"end":return s.stop()}}),null,null,null,Promise)},e.getLocation=function(){var t,n,r;return D.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,D.a.awrap(G.b());case 2:if(t=o.sent,n=t.status,o.prev=4,"granted"!==n){o.next=10;break}return o.next=8,D.a.awrap(G.a({}).catch((function(e){console.error(e)})));case 8:(r=o.sent)&&e.props.onSend({location:{longitude:r.coords.longitude,latitude:r.coords.latitude}});case 10:o.next=15;break;case 12:o.prev=12,o.t0=o.catch(4),console.error(o.t0);case 15:case"end":return o.stop()}}),null,null,[[4,12]],Promise)},e.onActionPress=function(){var t=["Choose From Library","Take Picture","Send Location","Cancel"],n=t.length-1;e.context.actionSheet().showActionSheetWithOptions({options:t,cancelButtonIndex:n},(function(t){return D.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:n.t0=t,n.next=0===n.t0?3:1===n.t0?5:2===n.t0?7:9;break;case 3:return console.log("user wants to pick an image"),n.abrupt("return",e.pickImage());case 5:return console.log("user wants to take a photo"),n.abrupt("return",e.takePhoto());case 7:return console.log("user wants to get their location"),n.abrupt("return",e.getLocation());case 9:case"end":return n.stop()}}),null,null,null,Promise)}))},e}return s()(n,[{key:"render",value:function(){return Object(A.jsx)(v.a,{accessible:!0,accessibilityLabel:"More options",accessibilityHint:"Let\u2019s you choose to send an image or your geolocation.",style:[X.container],onPress:this.onActionPress,children:Object(A.jsx)(b.a,{style:[X.wrapper,this.props.wrapperStyle],children:Object(A.jsx)(m.a,{style:[X.iconText,this.props.iconTextStyle],children:"+"})})})}}]),n}(d.a.Component),X=g.a.create({container:{width:26,height:26,marginLeft:10,marginBottom:10},wrapper:{borderRadius:13,borderColor:"#b2b2b2",borderWidth:2,flex:1},iconText:{color:"#b2b2b2",fontWeight:"bold",fontSize:16,backgroundColor:"transparent",textAlign:"center"}});function q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?q(Object(n),!0).forEach((function(t){T()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ee(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var o=f()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return l()(this,n)}}K.contextTypes={actionSheet:Q.a.func};var te=n(175);n(204);var ne={apiKey:"AIzaSyAaCpkI74xxLxdrDNZCIuQrDwEeDBT2Y9c",authDomain:"chat-app-c58e8.firebaseapp.com",databaseURL:"https://chat-app-c58e8-default-rtdb.firebaseio.com",projectId:"chat-app-c58e8",storageBucket:"chat-app-c58e8.appspot.com",messagingSenderId:"366013209951",appId:"1:366013209951:web:76d07df3dc6454e00c2aea",measurementId:"G-6B58C8Q8LF"},re=function(e){i()(n,e);var t=ee(n);function n(){var e;return o()(this,n),(e=t.call(this)).onCollectionUpdate=function(t){var n=[];t.forEach((function(e){var t=e.data();n.push({_id:t._id,text:t.text,createdAt:t.createdAt.toDate(),user:{_id:t.user._id,name:t.user.name,avatar:t.user.avatar},image:t.image||null,location:t.location||null})})),e.setState({messages:n}),e.saveMessages()},e.renderCustomActions=function(e){return Object(A.jsx)(K,$({},e))},e.state={messages:[],uid:0,user:{_id:"",name:"",avatar:""},isConnected:!1,image:null,location:null},te.apps.length||te.initializeApp(ne),e.referenceChatMessages=te.firestore().collection("messages"),e.refMsgsUser=null,J.a.ignoreLogs(["Setting a timer","Warning: ...","undefined","Animated.event now requires a second argument for options"]),e}return s()(n,[{key:"componentDidMount",value:function(){var e=this,t=this.props.route.params.name;this.props.navigation.setOptions({title:t}),z.a.fetch().then((function(n){n.isConnected?(e.setState({isConnected:!0}),console.log("online"),e.unsubscribe=e.referenceChatMessages.orderBy("createdAt","desc").onSnapshot(e.onCollectionUpdate),e.authUnsubscribe=te.auth().onAuthStateChanged((function(n){return D.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:if(n){r.next=4;break}return r.next=3,D.a.awrap(te.auth().signInAnonymously());case 3:return r.abrupt("return",r.sent);case 4:e.setState({uid:n.uid,messages:[],user:{_id:n.uid,name:t,avatar:"https://placeimg.com/140/140/any"}}),e.refMsgsUser=te.firestore().collection("messages").where("uid","==",e.state.uid);case 6:case"end":return r.stop()}}),null,null,null,Promise)})),e.saveMessages()):(console.log("offline"),e.setState({isConnected:!1}),e.getMessages())}))}},{key:"componentWillUnmount",value:function(){this.state.isConnected&&(this.authUnsubscribe(),this.unsubscribe())}},{key:"getMessages",value:function(){var e;return D.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return e="",t.prev=1,t.next=4,D.a.awrap(L.AsyncStorage.getItem("messages"));case 4:if(t.t0=t.sent,t.t0){t.next=7;break}t.t0=[];case 7:e=t.t0,this.setState({messages:JSON.parse(e)}),t.next=14;break;case 11:t.prev=11,t.t1=t.catch(1),console.log(t.t1.message);case 14:case"end":return t.stop()}}),null,this,[[1,11]],Promise)}},{key:"saveMessages",value:function(){return D.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,D.a.awrap(L.AsyncStorage.setItem("messages",JSON.stringify(this.state.messages)));case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log(e.t0.message);case 8:case"end":return e.stop()}}),null,this,[[0,5]],Promise)}},{key:"deleteMessages",value:function(){return D.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,D.a.awrap(L.AsyncStorage.removeItem("messages"));case 3:this.setState({messages:[]}),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.log(e.t0.message);case 9:case"end":return e.stop()}}),null,this,[[0,6]],Promise)}},{key:"addMessages",value:function(){var e=this.state.messages[0];this.referenceChatMessages.add({_id:e._id,text:e.text||"",createdAt:e.createdAt,user:this.state.user,image:e.image||"",location:e.location||null})}},{key:"onSend",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.setState((function(e){return{messages:U.b.append(e.messages,t)}}),(function(){e.addMessages(),e.saveMessages()}))}},{key:"renderBubble",value:function(e){return Object(A.jsx)(U.a,$($({},e),{},{wrapperStyle:{right:{backgroundColor:"#000"}},textStyle:{right:{color:"#fff"}}}))}},{key:"renderInputToolbar",value:function(e){if(0!=this.state.isConnected)return Object(A.jsx)(U.c,$({},e))}},{key:"renderCustomView",value:function(e){var t=e.currentMessage;return t.location?Object(A.jsx)(V.a,{style:{width:300,height:200,borderRadius:13,margin:3},region:{latitude:t.location.latitude,longitude:t.location.longitude,latitudeDelta:.0922,longitudeDelta:.0421}}):null}},{key:"render",value:function(){var e=this,t=this.props.route.params.bgColor;return Object(A.jsx)(b.a,{style:oe.container,children:Object(A.jsxs)(b.a,{style:$($({},oe.container),{},{backgroundColor:t}),children:[Object(A.jsx)(U.b,{renderBubble:this.renderBubble.bind(this),messages:this.state.messages,onSend:function(t){return e.onSend(t)},renderInputToolbar:this.renderInputToolbar.bind(this),renderActions:this.renderCustomActions,renderCustomView:this.renderCustomView,user:{_id:this.state.user._id,name:this.state.user.name,avatar:this.state.user.avatar}}),"android"===Y.a.OS?Object(A.jsx)(E.a,{behavior:"height"}):null]})})}}]),n}(d.a.Component),oe=g.a.create({container:{flex:1}}),ae=n(392),se=n(393);function ce(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var o=f()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return l()(this,n)}}var ie=Object(se.a)(),ue=function(e){i()(n,e);var t=ce(n);function n(){return o()(this,n),t.apply(this,arguments)}return s()(n,[{key:"render",value:function(){return Object(A.jsx)(ae.a,{children:Object(A.jsxs)(ie.Navigator,{initialRouteName:"Start",children:[Object(A.jsx)(ie.Screen,{name:"Start",component:B}),Object(A.jsx)(ie.Screen,{name:"Chat",component:re})]})})}}]),n}(p.Component);g.a.create({container:{flex:1,backgroundColor:"#fff",alignItems:"center",justifyContent:"center"}})},268:function(e,t,n){e.exports=n(385)},361:function(e,t,n){e.exports=n.p+"static/media/backgroundImage.91b21903.png"},362:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAMAAACnUt2HAAAA21BMVEUAAAAAAP+AgIBVVapxcY6AZoBxcYB5a4Zzc4B5bYZ0dIB2bYB4cYB1bYNzc4Z2cINzb4J2cYRzb4R1cYJ2coF1cYN3b4F0cYR2b4N0cYR2cIN0cYR2cIN0cYJ1b4R0b4J1cIJ0b4N0b4N2cYJ1cIR2b4N0cIN2cIN0cIN1b4J0cYN1b4N1cIN1b4R1cIR1cIR1b4J1cIN1cIJ1cYN1cIN1cIR1cIN1cIN2cIN0cIN1cIN1cIN1cIN1cIN1cYN1cIN1cIN1cIN2cIN1b4N1cIN1cIN1cIN1cIP///8+6D+xAAAASHRSTlMAAQIDCQoSExQVFhwiIygpNTY+P0FGR01OT1BRUlZXXGBjZWZ0dX2EhoeIjpCXmZ2ur7Kzubq7wMHDxMjJ2N7g4eXm5+jp6/Hsh4NzAAAAAWJLR0RI8ALU6gAAAKFJREFUGBmFwWcXQmAABtCnKKS9qJQUbZTR3kP//x/lOE54+9C9+OJ5kHrn2/3cRYJyKgOVUx8xmWcRvtKDRqS+Q2BfQ6TpIOA0EGE8Fj7OyyJm6rIAtx4jjpq9bPs1oZCUEwUO/zHiSLcsfSRkEUp33PdSFapVQVu9nXYKvsJxI9II0a3tIQ/krgoSBhcO2hyEhQpDBkE2YJhDgmlAmv2QPpmGE9X+GpHGAAAAAElFTkSuQmCC"}},[[268,1,2]]]);
//# sourceMappingURL=app.6d9a79bd.chunk.js.map